# app.yaml
# Este archivo configura cómo DigitalOcean App Platform desplegará y ejecutará tu aplicación.
# Asegúrate de que este archivo esté en el directorio raíz de tu proyecto.

# Nombre de la aplicación (se usará en la URL y la UI de DO)
name: pesc-ar-app # Puedes cambiar este nombre

# Especifica los servicios web para tu aplicación
services:
  - name: web # Nombre de este servicio web
    type: web
    # Especifica explícitamente el lenguaje. El buildpack de Python se inferirá junto con .python-version.
    language: python

    # Directorio raíz donde se encuentra tu código ( '.' significa el directorio actual)
    source_dir: .

    # Comando que se ejecuta para construir tu aplicación.
    # Para Python, esto suele ser la instalación de las dependencias.
    build_command: pip install -r requirements.txt

    # Comando para iniciar tu aplicación Flask con Gunicorn.
    # Esto elimina la necesidad de un Procfile, centralizando la configuración aquí.
    start_command: python -m gunicorn --workers 1 --bind 0.0.0.0:8080 app:app

    # Puerto HTTP en el que la aplicación escuchará.
    # DigitalOcean App Platform espera que las aplicaciones web escuchen en el puerto 8080.
    # Asegúrate de que tu aplicación Flask esté configurada para escuchar en este puerto.
    http_port: 8080

    # Rutas que se mapearán a este servicio.
    # 'path: /' significa que este servicio manejará todas las rutas base.
    routes:
      - path: /
        preserve_path_prefix: true # Mantiene el prefijo de la ruta al redirigir a este servicio.

    # Especifica las variables de entorno para este servicio.
    # La clave API de Gemini será inyectada automáticamente por el entorno de Canvas.
    # Si tuvieras otras variables de entorno personalizadas, las definirías aquí.
    # envs:
    #   - key: MY_CUSTOM_VARIABLE
    #     value: "some_value"

    # Configuración de recursos (opcional, ajusta según tus necesidades y costos)
    # instance_size_slug: basic-xxs # Por ejemplo, 'basic-xxs' (512MB RAM, 1vCPU)
    # instance_count: 1 # Número de instancias para escalar (para empezar, 1 es suficiente)
